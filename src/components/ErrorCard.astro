---
import { CopyIcon } from 'lucide-react';

interface Props {
  message: string;
  title?: string;
}

const { message, title } = Astro.props;
---

<div
  class="max-w-lg mx-auto p-4 border border-algo-red rounded-md shadow-md"
>
  <div class="flex items-center gap-2">
    <span class="text-algo-red">
      <svg
        xmlns="http://www.w3.org/2000/svg"
        fill="none"
        viewBox="0 0 24 24"
        stroke-width="1.5"
        stroke="currentColor"
        class="w-6 h-6"
      >
        <path
          stroke-linecap="round"
          stroke-linejoin="round"
          d="M12 9v3m0 2.25h.01M21.75 12c0 5.385-4.365 9.75-9.75 9.75S2.25 17.385 2.25 12 6.615 2.25 12 2.25 21.75 6.615 21.75 12z"
        ></path>
      </svg>
    </span>
    <span class="text-2xl text-algo-red  grow"
      >{title ? title : "Error"}</span
    >
    <button
      id="copy-error-btn"
      data-message={message}
      class="inline-flex items-center justify-center h-6 p-1 rounded-md text-algo-red hover:bg-algo-red/10 transition-colors"
      title="Copy error to clipboard"
    >
      <CopyIcon className="size-5" />
    </button>
  </div>
  <p class="mt-2 text-xl text-algo-red">{message}</p>
</div>

<script>
  const btn = document.getElementById('copy-error-btn');
  btn?.addEventListener('click', async () => {
    const message = btn.getAttribute('data-message') ?? '';
    const text = `Error: ${message}\nURL: ${window.location.href}`;
    await navigator.clipboard.writeText(text);
  });
</script>
